-- configuration for all DPDK command line parameters
-- see DPDK documentation for more details
-- The DPDK EAL Parameters documentation is located at http://dpdk.org/doc/guides/testpmd_app_ug/run_app.html
-- MoonGen tries to choose reasonable defaults, so this config file can almost always be empty
-- Attention when running MoonGen in a VM that also uses another 'virtio' NIC e.g. for internet access.
-- In this case it is required to whitelist the PCI IDs used (one could probably also blacklist all others).
DPDKConfig {
	-- configure the cores to use, either as a bitmask or as a list
	-- default: all cores
	--cores = 0x0F, -- use the first 4 cores
    {% if cpu_cores is not defined or cpu_cores == "" %}
	--cores = {0, 1, 3, 4},
    {% else %}
    cores = { {{ cpu_cores }} },
    {% endif %}

	-- the number of memory channels (defaults to auto-detect)
    {% if memoryChannels is not defined or memoryChannels == "" %}
	--memoryChannels = 2,
    {% else %}
	memoryChannels = {{ memoryChannels }},
    {% endif %}

	-- the configures requried to run multiple DPDK applications. Refer to
	-- http://dpdk.org/doc/guides/prog_guide/multi_proc_support.html#running-multiple-independent-dpdk-applications
	-- for more information.

	-- a string to be the prefix, corresponding to EAL argument "--file-prefix"
    {% if fileprefix is not defined or fileprefix == "" %}
	--fileprefix = "m1",
    {% else %}
	fileprefix = "{{ fileprefix }}",
    {% endif %}

	-- A string to specify the socket memory allocation, corresponding to EAL argument "--socket-mem"
    {% if socketmem is not defined or socketmem == "" %}
	--socketmem = "2048,2048",
    {% else %}
	socketmem = "{{ socketmem }}",
    {% endif %}
	--
	-- PCI black list to avoid resetting PCI device assigned to other DPDK apps.
	-- Corresponding to ELA argument "--pci-blacklist"
    {% if pciblack is not defined or pciblack == "" %}
	-- pciblack = {"0000:81:00.3","0000:81:00.1"},
    {% else %}
	pciblack = { {{ pciblack }} },
    {% endif %}

	-- PCI white list to specify devices allocated to MoonGen.
	-- Corresponding to ELA argument "--pci-whitelist" or "-w"
    {% if pciwhite is not defined or pciwhite == "" %}
	-- pciwhite = {"0000:81:00.3","0000:81:00.1"},
    {% else %}
	pciwhite = { {{ pciwhite }} },
    {% endif %}

	-- disable hugetlb, see DPDK documentation for more information
    {% if noHugeTlbFs is not defined or noHugeTlbFs == "" %}
	--noHugeTlbFs = true,
    {% else %}
	noHugeTlbFs = {{ noHugeTlbFs }},
    {% endif %}
}
